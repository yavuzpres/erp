<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <data>
        <template id="report_purchaseorder_inherit_demo" inherit_id="purchase.report_purchaseorder_document">
            <xpath expr="//table[@class='table table-sm o_main_table']" position="replace">
                <t t-set="o" t-value="o.with_context(lang=o.partner_id.lang)"/>
                <t t-set="address">
                    <div t-field="o.partner_id"
                         t-options='{"widget": "contact", "fields": ["address", "name", "phone"], "no_marker": True, "phone_icons": True}'/>
                    <p t-if="o.partner_id.vat"><t t-esc="o.company_id.country_id.vat_label or 'Tax ID'"/>:
                        <span t-field="o.partner_id.vat"/>
                    </p>
                </t>
                <t t-if="o.dest_address_id">
                    <t t-set="information_block">
                        <strong>Shipping address:</strong>
                        <div t-if="o.dest_address_id">
                            <div t-field="o.dest_address_id"
                                 t-options='{"widget": "contact", "fields": ["address", "name", "phone"], "no_marker": True, "phone_icons": True}'
                                 name="purchase_shipping_address"/>
                        </div>

                    </t>
                </t>
                <table class="table table-sm o_main_table">
                    <xpath expr="//table[@class='table table-sm o_main_table']//thead]" position="replace">
                        <!--                    <thead>-->
                        <tr>
                            <th name="th_description">
                                <strong>Description</strong>
                            </th>
                            <th name="th_taxes">
                                <strong>Taxes</strong>
                            </th>
                            <th name="th_date_req" class="text-center">
                                <strong>Date Req.</strong>
                            </th>
                            <th name="th_quantity" class="text-right">
                                <strong>Qty</strong>
                            </th>
                            <th name="th_price_unit" class="text-right">
                                <strong>Unit Price</strong>
                            </th>
                            <th name="th_discount_in_percentage" class="text-right">
                                <strong>Fixed Discount Percentage</strong>

                            </th>
                            <th name="th_discount" class="text-right">
                                <strong>Fixed Discount price</strong>
                            </th>
                            <th name="th_amount" class="text-right">
                                <strong>Amount</strong>
                            </th>
                        </tr>

                        <tbody>
                            <t t-set="current_subtotal" t-value="0"/>
                            <t t-foreach="o.order_line" t-as="line">

                                <tr>
                                    <xpath expr="//t[@t-foreach='o.order_line']//td[@id='product']" position="replace">
                                        <td id="product">
                                            <span t-field="line.name"/>
                                            <t t-if="line.product_id.l10n_in_hsn_code and o.company_id.country_id.code == 'IN'">
                                                <h6>
                                                    <strong class="ml16">HSN/SAC Code:</strong>
                                                    <span t-field="line.product_id.l10n_in_hsn_code"
                                                          position="replace"/>
                                                </h6>
                                            </t>
                                        </td>
                                    </xpath>

                                    <td name="td_taxes">
                                        <span t-esc="', '.join(map(lambda x: x.name, line.taxes_id))"/>
                                    </td>
                                    <td class="text-center">
                                        <span t-field="line.date_planned"/>
                                    </td>
                                    <td class="text-right">
                                        <span t-field="line.product_qty"/>
                                        <span t-field="line.product_uom.name" groups="uom.group_uom"/>
                                    </td>
                                    <td class="text-right">
                                        <span t-field="line.price_unit"/>
                                    </td>
                                    <td class="text-right">
                                        <span t-field="line.discount_in_percentage"/>

                                    </td>
                                    <td class="text-right">
                                        <span t-field="line.discount"/>
                                    </td>
                                    <td class="text-right">
                                        <span t-field="line.price_subtotal"
                                              t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                    </td>
                                </tr>
                            </t>
                        </tbody>
                    </xpath>
                </table>
            </xpath>
            <xpath expr="//div[@class='row justify-content-end']" position="replace">
                <div class="row justify-content-end">

                    <xpath expr="//div[@class='col-4']" position="replace">


                        <table class='table table-sm'>
                            <xpath expr="//table[@class='table table-sm']" position="replace" >

                                <tr class="border-black" position="replace" >
                                    <td name="td_subtotal_label">
                                        <strong>Subtotal</strong>
                                    </td>
                                    <td class="text-right">
                                        <span t-field="o.amount_untaxed"
                                              t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                    </td>
                                </tr>

                                <tr>
                                    <td name="td_taxes_label">Taxes</td>
                                    <td class="text-right">
                                        <span t-field="o.amount_tax"
                                              t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                    </td>
                                </tr>
                                <tr>
                                    <td name="td_discounts">Order Discount Fixed Amount</td>
                                    <td class="text-right">
                                        <span t-field="o.discounts"
                                              t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                    </td>
                                </tr>
                                <tr>
                                    <td name="td_discs_price">Order Discount percentage Equal Amount
                                    </td>
                                    <td class="text-right">
                                        <span t-field="o.discs_price"
                                              t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                    </td>
                                </tr>
                                <tr>
                                    <td name="td_extra_discount_in_price">Total Product Discount
                                        Fixed
                                        Amount
                                    </td>
                                    <td class="text-right">
                                        <span t-field="o.extra_discount_in_price"
                                              t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                    </td>
                                </tr>
                                <tr style="">
                                    <td name="td_ex_dis_perc_eql_price">Total Product Discount
                                        Percentage
                                        Equal Price
                                    </td>
                                    <td class="text-right">
                                        <span t-field="o.ex_dis_perc_eql_price"
                                              t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                    </td>
                                </tr>
                                <tr class="border-black o_total" style="">
                                    <td name="td_amount_total_label">
                                        <strong>Total</strong>
                                    </td>
                                    <td class="text-right">
                                        <span t-field="o.amount_total"
                                              t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                    </td>
                                </tr>
                            </xpath>
                        </table>
                    </xpath>
                </div>
            </xpath>
        </template>
    </data>
</odoo>